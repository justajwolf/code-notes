# v8

> nodejs关于v8参数，详见 `$ node --v8-options > v8_opts.txt` 命令

## 垃圾回收机制

垃圾回收策略：分代式垃圾回收

- 新生代
  - gc过程，空间小，耗时短，暂定所有逻辑执行
  - 算法：scavenge
    - 原理：
      - 新生代空间，对半分，两个半区，from半区和to半区
      - 每次新生代gc，会从from半区，复制活跃对象到to半区
      - 每次gc结束，from和to半区，会翻转
      - 新对象，只会分配在from半区里
    - 在gc过程中，新生代 直接跃升 老生代的条件：
      - 当前，对象之前被gc移动过
      - to半区的空间达到一定比例

- 老生代
  - gc过程，空间大，耗时长，gc与逻辑交替执行
  - 算法：mark-sweap
    - 原理：
      - 遍历所有老生代对象，标记不活跃的对象
      - 遍历完事后，清除被标记的对象，完成空间回收
    - 执行时机
      - 大多数情况下，都执行的是mark-sweap算法

  - 算法：mark-compact
    - 原理：
      - 遍历所有老生代对象，标记不活跃的对象
      - 移动活跃对象，向一个方向靠齐，整理空间碎片
      - 清除掉反方向，没有活跃对象的空间
    - 执行时机
      - 当前老生代无法分配，连续的大对象空间时
        - 执行mark-compact算法，进行回收和空间整理

## 内存的了解，使用和控制

### 栈内存

### 堆内存

### 堆外内存
